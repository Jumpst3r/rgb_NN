/*------------------------------------------------------------------------------------------------
This file was automatically generated by NeuralNetwork
Gen time: 29.07.2017 at 11:23:09. Use -lm flag when compiling to get access to the exp() function from math.h
This function returns an array of doubles indicating the probability of each color (same order as the)
training data set (eg: r,g,b,v,c)
--------------------------------------------------------------------------------------------------*/


#include <math.h>
double hiddenOut1[11];
double hiddenOut2[11];
double out[8];
double hl1WeightMatrix1[10][4] = {{0.3277562571052274,-0.4958609165973509,0.008900833978363387,0.4069339472715017},{-0.3612081806040331,-0.14092314061279954,0.3282927314782431,0.2966974134778845},{0.030904243136877008,-0.035766165489728496,0.14397283581908904,0.5023322431521584},{0.4029271039594524,-0.33199856515427595,0.27214515039025333,-0.4527562696455397},{-0.48945418262099505,0.27757105669674786,-0.3677875340236255,0.2338250171078483},{-0.4149932550157207,0.22087463343010583,0.28347349850474113,-0.2146495938650494},{-0.1868100677737659,-0.2385729844505028,0.4006761707512807,-0.3995181858462825},{-0.49074259959560945,-0.1962887649604837,-0.12128067937353143,-0.48961798261760275},{0.32525443213838945,-0.21912545489196433,-0.40466255250748573,0.42197148641435833},{-0.0471611149620077,0.40054458890955447,-0.4531750756015548,-0.19856540879693796}};
double hl2WeightMatrix1[10][11] = {{-0.3002546478679669,-0.2140369027628185,0.08485302397184785,0.2545353590920253,-0.12921530759681957,0.13550330382695447,-0.009597308724963505,-0.15816344257453485,-0.29280054360637864,0.06992049508441445,0.12293800399342197},{0.29681730065504586,-0.015568934710645743,-0.26822048971324103,-0.01599795023440631,-0.23930362388089751,0.11542790380360118,-0.3001974853199919,0.042869665796764544,0.15227609276561915,-0.02414743045661677,0.09571928987033462},{-0.007030689885424712,-0.0021238759178237587,-0.13783983304806252,0.20411871761112466,-0.04500784237444644,0.10962164484641707,-0.2793636058324739,0.018580788166143836,-0.15397833436635974,0.013563065025744725,0.18065073849033347},{0.0012785310473349965,-0.21823509875742264,0.26052793514847383,-0.0018079630583209827,-0.07375934757326436,0.2553015895683718,-0.25298040553342094,0.16153193583517594,-0.10678259294912343,0.22573854199829713,0.2679479253021455},{0.19457424375343102,0.2902595759872484,-0.13801591922308973,-0.2959787270227029,-0.261310614231131,-0.09889834866652994,-0.1442631900577597,0.27458549416409284,-0.20839556136418358,-0.17026438367752383,0.27856359038607936},{-0.2988803145985472,0.18251960440475534,0.010281259032722201,0.010755411569889461,-0.2182077638413431,-0.1883671238057955,-0.3010716960928176,-0.27337609248230155,0.22188229804572746,0.3098159586770397,0.13775568836651714},{-0.17257785329560113,0.2962848917695041,-0.06805830840745178,0.26056763082399303,0.17838534589926686,0.055634152103550494,0.059424181967798084,-0.23574311696038341,-0.22622467988482864,-0.0754614347583869,0.2957163486001927},{-0.20709358549755413,0.25793903342510494,-0.10672806312745542,-0.050505060384902434,-0.2850394459306227,0.008348073702059366,-0.1575847484451802,-0.18656676265519365,-0.2638224821059922,-0.09129633838766418,0.02883404607375789},{-0.02015415008277649,0.2939911486786896,0.2614087279825166,-0.11843353355173863,0.027641244340883442,0.1607680459551571,-0.07968568693840197,-0.19315993003288337,0.2103495736764479,-0.2900912758809346,0.1743269355922975},{-0.1848380566691648,0.25864822088286854,0.012978490868808923,0.14200262090221005,0.06185186061022585,-0.1063952292878472,0.2681090496172993,-0.16624961641483574,0.1429084128420559,0.15310744106344681,-0.27901270634791075}};
double outWeightMatrix1[8][11] = {{0.2980881004424183,-0.1923870861615054,-0.2758047626677403,0.16864201896275272,0.020728552920012022,-0.1383847977942441,0.24390272378959654,-0.1404640487856247,0.05840235542018718,0.06307862712751217,0.0728630446073138},{0.11865808239751491,-0.041631024609912026,-0.13700619627926844,0.1538371141383451,0.021161850069500332,0.1387076836915488,0.11389087417570487,-0.1526879308766684,-0.08915099524077219,-0.1774529331933976,-0.13172208006992317},{0.09698949937631168,-0.24122014395297392,-0.2784924272753108,2.7718384041164335E-4,-0.10167196497017661,0.2705601879849372,-0.20317209903690214,0.2374392768711847,0.03183126665958691,0.18256200497316,-0.18248116191506658},{0.11496955664157021,-0.12899782968426268,-0.23122450486058732,-0.12118069361391276,-0.05053450628287337,0.1663238905385368,0.1661650087449157,0.16982492247181186,0.18638288474984482,-0.08348375931021049,-0.2646900816310067},{-0.09960850264721632,0.15690907975662033,-0.07768888055399562,0.3110488277167388,0.03406618372686637,0.2378566520358184,0.19600559974383225,-0.0065352818276426805,0.017132833331832964,0.24386215228721175,-0.00951937436611483},{0.11470611529348013,-0.006472950356232798,0.24399918533774345,-0.18635229267979414,0.20293754606455616,0.028034910775328936,0.26198246955664617,-0.18471280434112117,-0.17052591870374947,-0.13488843834288,-0.25581141762991844},{0.19905204177843083,0.2179240340842613,0.2230222281139792,0.13843150587320474,-0.16102057110745507,0.08615021685551466,0.2430216636082455,0.13733751485820372,-0.19118333816451316,-0.11535704492815735,-0.17364890808706934},{0.22342563576196117,0.18482774290571924,0.12605651049424227,-0.13863172878582214,0.27861243022822235,0.13060264693502655,-0.20540374683884527,-0.0950510748660229,-0.12933610512973948,0.03827395724964061,-0.09683880184841176}};
double* query(double r, double g, double b);
double* query(double r, double g, double b){
    r = 2 * (r / 255.) - 1;
    g = 2 * (g / 255.) - 1;
    b = 2 * (b / 255.) - 1;

    double sum = 0;
    int i = 0;
    int j = 0;
    int n = 0;
    double inputs[4] = {r,g,b,-1};

    for(i = 0; i < 11 - 1; i++){
        sum = 0;
        for(j = 0; j < 4; j++){
            sum += inputs[j] * hl1WeightMatrix1[i][j];
        }
        hiddenOut1[i] = 1. / (1 + exp(-sum));
    }

    hiddenOut1[11 - 1] = -1;
    for(i = 0; i < 11-1;i++){
        sum = 0;
        for(j = 0; j < 11; j++){
            sum += hiddenOut1[j] * hl2WeightMatrix1[i][j];
        }
        hiddenOut2[i] = 1. / (1 + exp(-sum));
    }hiddenOut2[11-1] = -1 ;
    double weightedInput[8];
    double softmaxsum = 0;
    for(i = 0; i < 8; i++){
        sum = 0;
        for(j = 0; j < 11; j++){
            sum += hiddenOut2[j] * outWeightMatrix1[i][j];
        }
        weightedInput[i] = sum;
        softmaxsum += exp(weightedInput[i]);
    }
    for(n = 0; n < 8; n++){
        out[n] = exp(weightedInput[n]) / softmaxsum;
        out[n] = roundf(out[n] * 100) / 100;
    }
    return out;
}